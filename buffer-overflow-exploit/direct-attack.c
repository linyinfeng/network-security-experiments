#include "stdio.h"
#include "inttypes.h"

extern void foo(int a, int b, int c);

int main() {
    int x = 0;
    foo(1, 2, 3);
    x = 1; // try to skip this statement by function foo
    printf("%d\n", x);
}

void foo(int a, int b, int c) { // ignore arguments
    intptr_t *p;
    asm("\t movq %%rbp, %0" : "=r"(p));
    intptr_t *return_address = p + 1; // below caller rbp
    *return_address += 1; // should plus the size of "x = 1" statement
}

// void foo(int a, int b, int c) {
//     char buffer1[5];
//     char buffer2[10];
//     int *r;
//     r = (int *)buffer1 + 20;
//     (*r) += 8;
// }